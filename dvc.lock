schema: '2.0'
stages:
  get_bdb_2024_data:
    cmd: kaggle competitions download -c nfl-big-data-bowl-2024 -p data/
    outs:
    - path: data/nfl-big-data-bowl-2024.zip
      hash: md5
      md5: d39d15812f2c6aa9450eaef71f71e601
      size: 292799779
  unzip_bdb_2024_data:
    cmd: unzip data/nfl-big-data-bowl-2024.zip -d data/bdb_2024/
    deps:
    - path: data/nfl-big-data-bowl-2024.zip
      hash: md5
      md5: d39d15812f2c6aa9450eaef71f71e601
      size: 292799779
    outs:
    - path: data/bdb_2024
      hash: md5
      md5: c7869f4305b74f791c1de31cdee7982d.dir
      size: 1611304510
      nfiles: 13
  prep_data:
    cmd: rye run python src/prep_data.py
    deps:
    - path: data/bdb_2024/
      hash: md5
      md5: c7869f4305b74f791c1de31cdee7982d.dir
      size: 1611304510
      nfiles: 13
    - path: src/prep_data.py
      hash: md5
      md5: 3817ee4c9ee63c10d5a6d8b7dfaec5b9
      size: 10668
    outs:
    - path: data/split_prepped_data/
      hash: md5
      md5: 01e3f324290aa4e90854dc25b0bd1eae.dir
      size: 877418035
      nfiles: 6
  precompute_datasets:
    cmd: rye run python src/datasets.py
    deps:
    - path: data/split_prepped_data/
      hash: md5
      md5: 01e3f324290aa4e90854dc25b0bd1eae.dir
      size: 877418035
      nfiles: 6
    - path: src/datasets.py
      hash: md5
      md5: 908b51eed4bd744a2ff4da0afac59de5
      size: 6782
    outs:
    - path: data/datasets/transformer/
      hash: md5
      md5: ff8b7cade9a3641e0adf21d09353234f.dir
      size: 5495617760
      nfiles: 3
    - path: data/datasets/zoo/
      hash: md5
      md5: 9a8383e78b016c6e5d0003821d1ea440.dir
      size: 8729346073
      nfiles: 3
  precompute_datasets_with_play:
    cmd: rye run python src/datasets.py --play_features
    deps:
    - path: data/split_prepped_data/
      hash: md5
      md5: 01e3f324290aa4e90854dc25b0bd1eae.dir
      size: 877418035
      nfiles: 6
    - path: src/datasets.py
      hash: md5
      md5: 908b51eed4bd744a2ff4da0afac59de5
      size: 6782
    outs:
    - path: data/datasets/transformer_play/
      hash: md5
      md5: 60cc5588fac75c9992eb023616eb91f4.dir
      size: 5715986348
      nfiles: 3
    - path: data/datasets/zoo_play/
      hash: md5
      md5: 00923c185c5f840cfee299e9af09150f.dir
      size: 9831161761
      nfiles: 3
  train_transformer_models:
    cmd: rye run python src/train.py --model_type transformer
    deps:
    - path: data/datasets/transformer
      hash: md5
      md5: ff8b7cade9a3641e0adf21d09353234f.dir
      size: 5495617760
      nfiles: 3
    - path: src/datasets.py
      hash: md5
      md5: 908b51eed4bd744a2ff4da0afac59de5
      size: 6782
    - path: src/models.py
      hash: md5
      md5: 2f01fe84ddcf118f5b3574439b6de732
      size: 8064
    - path: src/train.py
      hash: md5
      md5: f18494ca8169546fe7976efc37613f22
      size: 7050
    outs:
    - path: data/models/transformer/
      hash: md5
      md5: 30554042a2cff9f382a1e6cc1df52054.dir
      size: 866752412
      nfiles: 61
  train_zoo_models:
    cmd: rye run python src/train.py --model_type zoo
    deps:
    - path: data/datasets/zoo/
      hash: md5
      md5: 9a8383e78b016c6e5d0003821d1ea440.dir
      size: 8729346073
      nfiles: 3
    - path: src/datasets.py
      hash: md5
      md5: 908b51eed4bd744a2ff4da0afac59de5
      size: 6782
    - path: src/models.py
      hash: md5
      md5: 2f01fe84ddcf118f5b3574439b6de732
      size: 8064
    - path: src/train.py
      hash: md5
      md5: f18494ca8169546fe7976efc37613f22
      size: 7050
    outs:
    - path: data/models/zoo/
      hash: md5
      md5: 755b2e48d7bb544c5a68a5fbb3d70182.dir
      size: 459061502
      nfiles: 60
  train_transformer_model_with_play:
    cmd: rye run python src/train.py --model_type transformer --play_features
    deps:
    - path: data/datasets/transformer_play/
      hash: md5
      md5: 60cc5588fac75c9992eb023616eb91f4.dir
      size: 5715986348
      nfiles: 3
    - path: src/datasets.py
      hash: md5
      md5: 908b51eed4bd744a2ff4da0afac59de5
      size: 6782
    - path: src/models.py
      hash: md5
      md5: 2f01fe84ddcf118f5b3574439b6de732
      size: 8064
    - path: src/train.py
      hash: md5
      md5: f18494ca8169546fe7976efc37613f22
      size: 7050
    outs:
    - path: data/models/transformer_play/
      hash: md5
      md5: a9aa46aec69b309fafc445412c74a17c.dir
      size: 470894508
      nfiles: 41
  pick_best_models:
    cmd: rye run python src/pick_best_models.py
    deps:
    - path: data/models/
      hash: md5
      md5: e22fe282882e06b3170f7d9152d12c79.dir
      size: 1796708631
      nfiles: 164
    - path: src/datasets.py
      hash: md5
      md5: 908b51eed4bd744a2ff4da0afac59de5
      size: 6782
    - path: src/models.py
      hash: md5
      md5: 2f01fe84ddcf118f5b3574439b6de732
      size: 8064
    - path: src/pick_best_models.py
      hash: md5
      md5: ebcce4c3933bbe5abc9b11e5ce5a62d3
      size: 2642
    outs:
    - path: data/best_models/
      hash: md5
      md5: 08817c534d9d6596ee1061a9d992465d.dir
      size: 133987487
      nfiles: 6
